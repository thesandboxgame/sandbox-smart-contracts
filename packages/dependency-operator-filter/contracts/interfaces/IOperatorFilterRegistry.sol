// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

/// @title IOperatorFilterRegistry
/// @notice Interface for managing operators and filtering.
interface IOperatorFilterRegistry {
    ///@notice Returns true if operator is not filtered for a given token, either by address or codeHash. Also returns
    ///        true if supplied registrant address is not registered.
    function isOperatorAllowed(address registrant, address operator) external view returns (bool);

    ///@notice Registers an address with the registry. May be called by address itself or by EIP-173 owner.
    function register(address registrant) external;

    ///@notice Registers an address with the registry and "subscribes" to another address's filtered operators and codeHashes.
    function registerAndSubscribe(address registrant, address subscription) external;

    ///@notice Registers an address with the registry and copies the filtered operators and codeHashes from another
    ///        address without subscribing.
    function registerAndCopyEntries(address registrant, address registrantToCopy) external;

    ///@notice Unregisters an address with the registry and removes its subscription. May be called by address itself or by EIP-173 owner.
    ///        Note that this does not remove any filtered addresses or codeHashes.
    ///        Also note that any subscriptions to this registrant will still be active and follow the existing filtered addresses and codehashes.
    function unregister(address addr) external;

    ///@notice Update an operator address for a registered address - when filtered is true, the operator is filtered.
    function updateOperator(
        address registrant,
        address operator,
        bool filtered
    ) external;

    ///@notice Update multiple operators for a registered address - when filtered is true, the operators will be filtered. Reverts on duplicates.
    function updateOperators(
        address registrant,
        address[] calldata operators,
        bool filtered
    ) external;

    ///@notice Update a codeHash for a registered address - when filtered is true, the codeHash is filtered.
    function updateCodeHash(
        address registrant,
        bytes32 codehash,
        bool filtered
    ) external;

    ///@notice Update multiple codeHashes for a registered address - when filtered is true, the codeHashes will be filtered. Reverts on duplicates.
    function updateCodeHashes(
        address registrant,
        bytes32[] calldata codeHashes,
        bool filtered
    ) external;

    ///@notice Subscribe an address to another registrant's filtered operators and codeHashes. Will remove previous
    ///        subscription if present.
    ///        Note that accounts with subscriptions may go on to subscribe to other accounts - in this case,
    ///        subscriptions will not be forwarded. Instead the former subscription's existing entries will still be
    ///        used.
    function subscribe(address registrant, address registrantToSubscribe) external;

    ///@notice Unsubscribe an address from its current subscribed registrant, and optionally copy its filtered operators and codeHashes.
    function unsubscribe(address registrant, bool copyExistingEntries) external;

    ///@notice Get the subscription address of a given registrant, if any.
    function subscriptionOf(address addr) external returns (address registrant);

    ///@notice Get the set of addresses subscribed to a given registrant.
    ///        Note that order is not guaranteed as updates are made.

    function subscribers(address registrant) external returns (address[] memory);

    ///@notice Get the subscriber at a given index in the set of addresses subscribed to a given registrant.
    ///        Note that order is not guaranteed as updates are made.
    function subscriberAt(address registrant, uint256 index) external returns (address);

    ///@notice Copy filtered operators and codeHashes from a different registrantToCopy to addr.

    function copyEntriesOf(address registrant, address registrantToCopy) external;

    ///@notice Returns true if operator is filtered by a given address or its subscription.
    function isOperatorFiltered(address registrant, address operator) external returns (bool);

    ///@notice Returns true if the hash of an address's code is filtered by a given address or its subscription.
    function isCodeHashOfFiltered(address registrant, address operatorWithCode) external returns (bool);

    ///@notice Returns true if a codeHash is filtered by a given address or its subscription.
    function isCodeHashFiltered(address registrant, bytes32 codeHash) external returns (bool);

    ///@notice Returns a list of filtered operators for a given address or its subscription.
    function filteredOperators(address addr) external returns (address[] memory);

    ///@notice Returns the set of filtered codeHashes for a given address or its subscription.
    ///        Note that order is not guaranteed as updates are made.
    function filteredCodeHashes(address addr) external returns (bytes32[] memory);

    ///@notice Returns the filtered operator at the given index of the set of filtered operators for a given address or
    ///        its subscription.
    ///        Note that order is not guaranteed as updates are made.
    function filteredOperatorAt(address registrant, uint256 index) external returns (address);

    ///@notice Returns the filtered codeHash at the given index of the list of filtered codeHashes for a given address or
    ///        its subscription.
    ///        Note that order is not guaranteed as updates are made.
    function filteredCodeHashAt(address registrant, uint256 index) external returns (bytes32);

    ///@notice Returns true if an address has registered
    function isRegistered(address addr) external returns (bool);

    ///@dev Convenience method to compute the code hash of an arbitrary contract
    function codeHashOf(address addr) external returns (bytes32);
}
